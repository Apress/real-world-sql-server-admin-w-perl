<HTML>
<HEAD>
<TITLE>compareIndexes - Compare two tables for any index difference</TITLE>
<LINK REV="made" HREF="mailto:">
</HEAD>

<BODY>
<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH=100%>
<TR><TD CLASS=block VALIGN=MIDDLE WIDTH=100% BGCOLOR="#cccccc">
<FONT SIZE=+1><STRONG><P CLASS=block>&nbsp;compareIndexes - Compare two tables for any index difference</P></STRONG></FONT>
</TD></TR>
</TABLE>

<A NAME="__index__"></A>
<!-- INDEX BEGIN -->

<UL>

	<LI><A HREF="#name">NAME</A></LI>
	<LI><A HREF="#synopsis">SYNOPSIS</A></LI>
	<LI><A HREF="#description">DESCRIPTION</A></LI>
	<LI><A HREF="#compare indexes">COMPARE INDEXES</A></LI>
	<LI><A HREF="#author">AUTHOR</A></LI>
	<LI><A HREF="#version">VERSION</A></LI>
</UL>
<!-- INDEX END -->

<HR>
<P>
<H1><A NAME="name">NAME</A></H1>
<P>compareIndexes - Compare two tables for any index difference</P>
<P>
<HR>
<H1><A NAME="synopsis">SYNOPSIS</A></H1>
<PRE>
 cmd&gt;perl compareIndexes.pl</PRE>
<P>For illustration purposes, the server instances, the databases, and the tables are all 
hard coded in the script. You can esily modify the script to accept a config file or 
retrieve the server info from the command line.</P>
<P>
<HR>
<H1><A NAME="description">DESCRIPTION</A></H1>
<P>This script shows how to compare two tables for any difference in their indexes.</P>
<P>The approach is to (1) retrieve the information about the indexes of each table using SQL-DMO, (2)
store the information in a Perl data structure, and (3) compare the two data structures.</P>
<P>The script relies on the <EM>dbaGetTableIndexes()</EM> function imported from the module SQLDBA::SQLDMO
to obtain the information on the table indexes. The script also imports two utility 
functions, <EM>dbaSetDiff()</EM> and <EM>dbaSetCommon()</EM>, to help with comparing the data structures. 
These two functions are imported from the module SQLDBA::Utility.</P>
<P>To see the behavior of the script, you can make the following modifictions to one of the table, and
run the script after each change:</P>
<UL>
<LI><STRONG><A NAME="item_Add_a_new_index_to_one_table">Add a new index to one table</A></STRONG><BR>

<LI><STRONG><A NAME="item_Change_the_index_keys_of_a_common_index_on_one_tab">Change the index keys of a common index on one table</A></STRONG><BR>

<LI><STRONG><A NAME="item_Change_the_clustered_index_on_one_table_to_non%2Dc">Change the clustered index on one table to non-clustered</A></STRONG><BR>

<LI><STRONG><A NAME="item_Change_the_fillfactor_of_an_index_on_one_table">Change the fillfactor of an index on one table</A></STRONG><BR>

</UL>
<P>The structure of this script is similr to that of the script compareColumns.pl in Listing 5-1.</P>
<P>
<HR>
<H1><A NAME="compare indexes">COMPARE INDEXES</A></H1>
<P>The script <EM>compareIndexes.pl</EM> compares two tables for ny difference in their indexes. If you want to
compare two indexes for any difference, take a look at the script <EM>compareIndexInfo.pl</EM>, which allows 
you to specify the index names in addition to the server names, database names, and the tble names.</P>
<P>
<HR>
<H1><A NAME="author">AUTHOR</A></H1>
<P>Linchi Shea</P>
<P>
<HR>
<H1><A NAME="version">VERSION</A></H1>
<PRE>
 2003.01.27</PRE>
<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH=100%>
<TR><TD CLASS=block VALIGN=MIDDLE WIDTH=100% BGCOLOR="#cccccc">
<FONT SIZE=+1><STRONG><P CLASS=block>&nbsp;compareIndexes - Compare two tables for any index difference</P></STRONG></FONT>
</TD></TR>
</TABLE>

</BODY>

</HTML>
