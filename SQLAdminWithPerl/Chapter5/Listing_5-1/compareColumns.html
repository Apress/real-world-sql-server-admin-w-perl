<HTML>
<HEAD>
<TITLE>compareColumns - Compare the columns of two tables for schema difference</TITLE>
<LINK REV="made" HREF="mailto:">
</HEAD>

<BODY>
<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH=100%>
<TR><TD CLASS=block VALIGN=MIDDLE WIDTH=100% BGCOLOR="#cccccc">
<FONT SIZE=+1><STRONG><P CLASS=block>&nbsp;compareColumns - Compare the columns of two tables for schema difference</P></STRONG></FONT>
</TD></TR>
</TABLE>

<A NAME="__index__"></A>
<!-- INDEX BEGIN -->

<UL>

	<LI><A HREF="#name">NAME</A></LI>
	<LI><A HREF="#synopsis">SYNOPSIS</A></LI>
	<LI><A HREF="#description">DESCRIPTION</A></LI>
	<LI><A HREF="#loading sqldmo">LOADING SQL-DMO</A></LI>
	<LI><A HREF="#author">AUTHOR</A></LI>
	<LI><A HREF="#version">VERSION</A></LI>
</UL>
<!-- INDEX END -->

<HR>
<P>
<H1><A NAME="name">NAME</A></H1>
<P>compareColumns - Compare the columns of two tables for schema difference</P>
<P>
<HR>
<H1><A NAME="synopsis">SYNOPSIS</A></H1>
<PRE>
 cmd&gt;perl compareColumns.pl</PRE>
<P>For illustration purposes, the server instances, the databases, and the tables are all 
hard coded in the script. You can esily modify the script to accept a config file or 
retrieve the server info from the command line.</P>
<P>
<HR>
<H1><A NAME="description">DESCRIPTION</A></H1>
<P>This script shows how to compare the columns of two tables for any difference in their schema.</P>
<P>The approach is to (1) retrieve the schema information about the columns of each table using SQL-DMO, (2)
store the schema information in a Perl data structure, and (3) compare the two data structures.</P>
<P>The script relies on the <EM>dbaGetTableColumns()</EM> function imported from the module SQLDBA::SQLDMO
to obtain the schema information on the table columns. The script also imports two utility 
functions, <EM>dbaSetDiff()</EM> and <EM>dbaSetCommon()</EM>, to help with comparing the data structures. 
These two functions are imported from the module SQLDBA::Utility.</P>
<P>The hard coded tables are the pubs..authors tables in two different databases. To see how the 
script works, change the columns of one table and then run the script. For instance, you can add
a new column to one authors table, and run the script to see whether it reports the difference 
in terms of this new column and how it reports the difference.</P>
<P>
<HR>
<H1><A NAME="loading sqldmo">LOADING SQL-DMO</A></H1>
<P>SQL-DMO is invoked through the module Win32::OLE, which is the gatewy to any OLE Automation from Perl. 
The rest is simply to sollow the hierarchy of a specific object model. The Win32::OLE module is not
directly used in this script. It's used in the imported function <EM>dbaGetTbleColumns()</EM>.</P>
<P>Note that the first when this script tries to load SQL-DMO, it may take several seconds. Subsequent
runs of the script should be lot quicker.</P>
<P>
<HR>
<H1><A NAME="author">AUTHOR</A></H1>
<P>Linchi Shea</P>
<P>
<HR>
<H1><A NAME="version">VERSION</A></H1>
<PRE>
 2003.01.27</PRE>
<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH=100%>
<TR><TD CLASS=block VALIGN=MIDDLE WIDTH=100% BGCOLOR="#cccccc">
<FONT SIZE=+1><STRONG><P CLASS=block>&nbsp;compareColumns - Compare the columns of two tables for schema difference</P></STRONG></FONT>
</TD></TR>
</TABLE>

</BODY>

</HTML>
